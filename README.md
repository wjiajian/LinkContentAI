# ğŸ“Š Excelé“¾æ¥æ–‡æ¡£å¢å¼ºå·¥å…·

ä¸€ä¸ªå¼ºå¤§çš„Pythonå·¥å…·ï¼Œç”¨äºè‡ªåŠ¨æå–Excelä¸­é“¾æ¥çš„æ–‡æ¡£å†…å®¹ï¼ˆPDFã€DOCXã€TXTã€XLSXï¼‰ï¼Œå¹¶ä½¿ç”¨å¤šæ¨¡æ€LLMåˆ†ææ–‡æ¡£ä¸­çš„å›¾ç‰‡ï¼Œæœ€ç»ˆå°†å®Œæ•´å†…å®¹æ’å…¥Excelå•å…ƒæ ¼ã€‚

[![Python Version](https://img.shields.io/badge/python-3.7+-blue.svg)](https://www.python.org/downloads/)
[![License](https://img.shields.io/badge/license-MIT-green.svg)](LICENSE)

---

## âœ¨ æ ¸å¿ƒç‰¹æ€§

### ğŸ¯ ä¸»è¦åŠŸèƒ½

- ğŸ“„ **å¤šæ ¼å¼æ”¯æŒ**: PDFã€DOCXã€TXTã€XLSXã€PPTXã€XMind
- ğŸ–¼ï¸ **å›¾ç‰‡åˆ†æ**: æ™ºèƒ½æå–å¹¶åˆ†ææ–‡æ¡£ä¸­çš„å›¾ç‰‡
- ğŸ¤– **AIå¢å¼º**: ä½¿ç”¨qwen-vlæ¨¡å‹ç”Ÿæˆå›¾ç‰‡è¯¦ç»†æè¿°
- ğŸ“ **Markdownè¾“å‡º**: ä¼˜é›…çš„æ ¼å¼åŒ–æ–‡æ¡£å†…å®¹
- ğŸ§¹ **è‡ªåŠ¨æ¸…ç†**: ä¸´æ—¶æ–‡ä»¶è‡ªåŠ¨ç®¡ç†
- ğŸ¨ **æ ¼å¼ä¼˜åŒ–**: å›¾ç‰‡æè¿°å¸¦é•¿æ¨ªçº¿åˆ†éš”ç¬¦
- ğŸ“Š **æ™ºèƒ½å®šä½**: ç²¾ç¡®æ£€æµ‹å›¾ç‰‡åœ¨æ–‡æ¡£ä¸­çš„ä½ç½®
- ğŸ” **è¯¦ç»†æ—¥å¿—**: å®æ—¶æ˜¾ç¤ºå¤„ç†è¿›åº¦
- ğŸ­ **æ¼”ç¤ºæ–‡ç¨¿**: æ”¯æŒPowerPointå¹»ç¯ç‰‡è§£æ
- ğŸ§  **æ€ç»´å¯¼å›¾**: æ”¯æŒXMindæ ¼å¼æ™ºèƒ½è½¬æ¢

### ğŸ”„ å¤„ç†æµç¨‹

```
Excelä¸­çš„é“¾æ¥æ–‡æ¡£
    â†“
æå–æ–‡æ¡£å†…å®¹å’Œå›¾ç‰‡
    â†“
è½¬æ¢ä¸ºMarkdownï¼ˆæ’å…¥å›¾ç‰‡å ä½ç¬¦ï¼‰
    â†“
ä½¿ç”¨qwen-vlåˆ†ææ¯å¼ å›¾ç‰‡
    â†“
ç”¨å›¾ç‰‡æè¿°æ›¿æ¢å ä½ç¬¦
    â†“
å®Œæ•´å†…å®¹æ’å…¥Excelå•å…ƒæ ¼
```

---

## ğŸ“¦ å®‰è£…

### 1ï¸âƒ£ å…‹éš†é¡¹ç›®
```bash
# é¡¹ç›®å·²åœ¨æ­¤ç›®å½•ï¼Œå¯ç›´æ¥ä½¿ç”¨
cd /path/to/project
```

### 2ï¸âƒ£ å®‰è£…Pythonä¾èµ–

```bash
pip install -r requirements.txt
```

**æ ¸å¿ƒä¾èµ–**ï¼š
- `openpyxl` - Excelæ–‡ä»¶å¤„ç†
- `python-docx` - Wordæ–‡æ¡£å¤„ç†
- `python-pptx` - PowerPointæ¼”ç¤ºæ–‡ç¨¿å¤„ç†
- `pdfplumber` - PDFæ–‡æœ¬æå–
- `pdf2image` - PDFå›¾ç‰‡æå–
- `openai` - å¤šæ¨¡æ€LLMè°ƒç”¨
- `Pillow` - å›¾ç‰‡å¤„ç†
- `poppler-utils` - PDFå›¾ç‰‡æå–å·¥å…·ï¼ˆå¿…éœ€ï¼‰

### 3ï¸âƒ£ å®‰è£…Popplerï¼ˆPDFå›¾ç‰‡æ”¯æŒï¼‰

**Windows**:
1. ä¸‹è½½ [Poppler for Windows](https://blog.alivate.com.au/poppler-windows/)
2. è§£å‹åˆ° `C:\poppler\` ç›®å½•
3. æ·»åŠ  `C:\poppler\bin` åˆ°PATHç¯å¢ƒå˜é‡

**macOS**:
```bash
brew install poppler
```

**Linux**:
```bash
sudo apt-get install poppler-utils
```

### 4ï¸âƒ£ é…ç½®APIå¯†é’¥

åœ¨ `write_file_excel.py` é¡¶éƒ¨ä¿®æ”¹ï¼š

```python
QWEN_VL_CONFIG = {
    "api_key": "æ‚¨çš„é€šä¹‰åƒé—®APIå¯†é’¥",  # âš ï¸ å¿…å¡«
    "base_url": "https://dashscope.aliyuncs.com/compatible-mode/v1",
    "model": "qwen-vl-plus",  # æˆ– qwen-vl-max
}
```

**è·å–APIå¯†é’¥**ï¼š
1. è®¿é—® [é˜¿é‡Œäº‘DashScopeæ§åˆ¶å°](https://dashscope.console.aliyun.com/)
2. åˆ›å»ºåº”ç”¨å¹¶è·å–API Key
3. ç¡®ä¿è´¦æˆ·æœ‰è¶³å¤Ÿä½™é¢

---

## ğŸš€ ä½¿ç”¨æ–¹æ³•

### æ–¹æ³•1ï¼šä¿®æ”¹è„šæœ¬ç›´æ¥è¿è¡Œ

1. æ‰“å¼€ `write_file_excel.py`
2. ä¿®æ”¹ç¬¬229è¡Œçš„æ–‡ä»¶è·¯å¾„ï¼š
```python
excel_file_path = "æ‚¨çš„Excelæ–‡ä»¶è·¯å¾„.xlsx"
```
3. è¿è¡Œç¨‹åºï¼š
```bash
python write_file_excel.py
```

### æ–¹æ³•2ï¼šä½œä¸ºæ¨¡å—è°ƒç”¨

```python
from write_file_excel import process_excel_in_place

# å¤„ç†Excelæ–‡ä»¶
process_excel_in_place("æ‚¨çš„Excelæ–‡ä»¶è·¯å¾„.xlsx")
```

---

## ğŸ“ è¾“å‡ºç¤ºä¾‹

### è¾“å‡ºç»“æœ

```markdown
--- ç¬¬ 1 é¡µ ---
é™„ä»¶æ–‡æœ¬å†…å®¹æ®µè½-1

================
**å›¾ç‰‡æè¿°:**
è¿™æ˜¯ä¸€å¼ æµç¨‹å›¾ï¼Œæ ‡é¢˜ä¸º"ç”¨æˆ·æŠ•è¯‰å¤„ç†æµç¨‹"ï¼Œé‡‡ç”¨è“è‰²ä¸»è‰²è°ƒï¼š

æµç¨‹æ­¥éª¤ï¼š
1. æ¥æ”¶æŠ•è¯‰
   - è®°å½•å®¢æˆ·åŸºæœ¬ä¿¡æ¯
   - æè¿°é—®é¢˜ç°è±¡
   - è®¾ç½®ä¼˜å…ˆçº§

2. é—®é¢˜åˆ†æ
   - æ£€æŸ¥ç³»ç»Ÿæ—¥å¿—
   - éªŒè¯é—®é¢˜é‡ç°
   - ç¡®å®šæ ¹æœ¬åŸå› 
.
.
.

================

é™„ä»¶æ–‡æœ¬å†…å®¹æ®µè½-1

================
**å›¾ç‰‡æè¿°**
å›¾ç‰‡æè¿°å†…å®¹

================
.
.
.

--- ç¬¬2é¡µ ---
.
.
.

```

### æ§åˆ¶å°è¾“å‡ºç¤ºä¾‹

```bash
æˆåŠŸåŠ è½½æ–‡ä»¶: 'C:\Users\Admin\Desktop\text\ä»»åŠ¡ç®¡ç†.xlsx'
å°†åŸºäºæ­¤ç›®å½•è§£æç›¸å¯¹è·¯å¾„: 'C:\Users\Admin\Desktop\text'
æ‰¾åˆ°äº† 1 ä¸ªè¶…é“¾æ¥ã€‚
æ£€æµ‹åˆ°é“¾æ¥åˆ—ä¸º H åˆ—ã€‚ å°†åœ¨ I åˆ—æ’å…¥æ–°å†…å®¹ã€‚
  - æ­£åœ¨å¤„ç† H10: 'ä»»åŠ¡ç®¡ç†-FILE/æ–‡æ¡£/10-æµç¨‹.pdf'
    æå–å›¾ç‰‡ä¸­...
    æå–åˆ° 3 å¼ å›¾ç‰‡
    è½¬æ¢ä¸ºMarkdownæ ¼å¼...
    ä½¿ç”¨å¤šæ¨¡æ€LLMåˆ†æå›¾ç‰‡...
    å¼€å§‹åˆ†æ 3 å¼ å›¾ç‰‡...
      ğŸ“¸ æ­£åœ¨åˆ†æå›¾ç‰‡ 1/3: page_1.png
        âœ… åˆ†æå®Œæˆ (æè¿°é•¿åº¦: 245 å­—ç¬¦)
      ğŸ“¸ æ­£åœ¨åˆ†æå›¾ç‰‡ 2/3: page_2.png
        âœ… åˆ†æå®Œæˆ (æè¿°é•¿åº¦: 312 å­—ç¬¦)
      ğŸ“¸ æ­£åœ¨åˆ†æå›¾ç‰‡ 3/3: page_3.png
        âœ… åˆ†æå®Œæˆ (æè¿°é•¿åº¦: 198 å­—ç¬¦)
    å›¾ç‰‡åˆ†æå®Œæˆï¼æˆåŠŸåˆ†æ 3 / 3 å¼ å›¾ç‰‡
    æ›¿æ¢å ä½ç¬¦...
    å®Œæˆ

æ­£åœ¨å°†æ›´æ”¹ä¿å­˜åˆ°åŸå§‹æ–‡ä»¶: 'C:\Users\Admin\Desktop\text\ä»»åŠ¡ç®¡ç†.xlsx'...
å¤„ç†å®Œæˆï¼åŸå§‹æ–‡ä»¶å·²æ›´æ–°ã€‚
```

### ğŸ­ PPTXæ ¼å¼æ”¯æŒç¤ºä¾‹

### è¾“å‡ºç»“æœ

```markdown
--- å¹»ç¯ç‰‡ 1 ---
## äº§å“ä»‹ç»

äº§å“æ¦‚è¿°
è¿™æ˜¯ä¸€æ¬¾åˆ›æ–°çš„è§£å†³æ–¹æ¡ˆ...

================
**å›¾ç‰‡æè¿°**
å›¾ç‰‡æè¿°å†…å®¹

================

--- å¹»ç¯ç‰‡ 2 ---
## æŠ€æœ¯æ¶æ„

æ ¸å¿ƒç»„ä»¶
- å‰ç«¯ï¼šReact
- åç«¯ï¼šPython
- æ•°æ®åº“ï¼šPostgreSQL

================
**å›¾ç‰‡æè¿°**
å›¾ç‰‡æè¿°å†…å®¹

================
```

### ğŸ§  XMindæ ¼å¼æ”¯æŒç¤ºä¾‹

### è¾“å‡ºç»“æœ

```markdown
# é¡¹ç›®è§„åˆ’

## é˜¶æ®µä¸€ï¼šéœ€æ±‚åˆ†æ
  - ç”¨æˆ·è°ƒç ”
  - éœ€æ±‚æ–‡æ¡£
  - éœ€æ±‚è¯„å®¡

## é˜¶æ®µäºŒï¼šè®¾è®¡é˜¶æ®µ
  æ¶æ„è®¾è®¡
  > å®ŒæˆæŠ€æœ¯é€‰å‹å’Œç³»ç»Ÿæ¶æ„è®¾è®¡

  æ¥å£è®¾è®¡
  æ ‡ç­¾: [é«˜ä¼˜å…ˆçº§]

## é˜¶æ®µä¸‰ï¼šå¼€å‘é˜¶æ®µ
  - å‰ç«¯å¼€å‘
  - åç«¯å¼€å‘
  - å•å…ƒæµ‹è¯•

```

---

## ğŸ—ï¸ æ¶æ„è¯´æ˜

### ä»£ç ç»“æ„

```
write_file_excel.py
â”œâ”€â”€ å¯¼å…¥å’Œé…ç½®
â”œâ”€â”€ ä¸´æ—¶æ–‡ä»¶ç®¡ç†
â”œâ”€â”€ æ–‡æ¡£è¯»å–å™¨
â”‚   â”œâ”€â”€ read_txt_content() - è¯»å–TXT
â”‚   â”œâ”€â”€ read_docx_content() - è¯»å–DOCX
â”‚   â”œâ”€â”€ read_xlsx_content() - è¯»å–XLSX
â”‚   â”œâ”€â”€ read_pptx_content() - è¯»å–PPTX
â”‚   â”œâ”€â”€ read_xmind_content() - è¯»å–XMind
â”‚   â””â”€â”€ read_pdf_content() - è¯»å–PDF
â”œâ”€â”€ å›¾ç‰‡æå–åŠŸèƒ½
â”‚   â”œâ”€â”€ extract_images_from_docx()
â”‚   â”œâ”€â”€ extract_images_from_pdf()
â”‚   â”œâ”€â”€ extract_images_from_pptx()
â”‚   â”œâ”€â”€ extract_images_from_xmind()
â”‚   â””â”€â”€ extract_images_from_document()
â”œâ”€â”€ æ–‡æ¡£è½¬æ¢åŠŸèƒ½
â”‚   â”œâ”€â”€ convert_docx_to_markdown_with_placeholders()
â”‚   â”œâ”€â”€ convert_pdf_to_markdown_with_placeholders()
â”‚   â”œâ”€â”€ convert_pptx_to_markdown_with_placeholders()
â”‚   â”œâ”€â”€ convert_xmind_to_markdown_with_placeholders()
â”‚   â””â”€â”€ convert_to_markdown_with_placeholders()
â”œâ”€â”€ å¤šæ¨¡æ€LLMè°ƒç”¨
â”‚   â”œâ”€â”€ encode_image_to_base64()
â”‚   â””â”€â”€ analyze_images_with_qwen_vl()
â”œâ”€â”€ å ä½ç¬¦æ›¿æ¢
â”‚   â””â”€â”€ replace_placeholders()
â”œâ”€â”€ æ–‡ä»¶åˆ†å‘å™¨
â”‚   â””â”€â”€ get_content_from_file()
â”œâ”€â”€ æ ¼å¼åŒ–è¾“å‡º
â”‚   â””â”€â”€ format_as_markdown()
â””â”€â”€ ä¸»å¤„ç†é€»è¾‘
    â””â”€â”€ process_excel_in_place()
```

### æ ¸å¿ƒè®¾è®¡æ¨¡å¼

1. **Reader Pattern** - æ‰©å±•å¼æ–‡ä»¶è¯»å–
2. **Template Method** - æ–‡æ¡£è½¬æ¢æ¨¡æ¿
3. **Strategy Pattern** - å¤šæ¨¡æ€LLMåˆ†æ
4. **Observer Pattern** - è¿›åº¦æ—¥å¿—è®°å½•

---

## âš™ï¸ é…ç½®è¯´æ˜

### APIé…ç½®

| å‚æ•° | è¯´æ˜ | é»˜è®¤å€¼ |
|------|------|--------|
| `api_key` | é€šä¹‰åƒé—®APIå¯†é’¥ | å¿…å¡« |
| `base_url` | APIæ¥å£åœ°å€ | `https://dashscope.aliyuncs.com/compatible-mode/v1` |
| `model` | æ¨¡å‹åç§° | `qwen-vl-plus` |

### é«˜çº§é…ç½®

å¦‚éœ€ä¿®æ”¹å›¾ç‰‡åˆ†æpromptï¼Œç¼–è¾‘ `analyze_images_with_qwen_vl()` å‡½æ•°ï¼ˆç¬¬371è¡Œï¼‰ï¼š

```python
"text": "è¯·è¯¦ç»†æè¿°è¿™å¼ å›¾ç‰‡çš„å†…å®¹ï¼ŒåŒ…æ‹¬æ–‡å­—ã€å›¾è¡¨ã€å¸ƒå±€ç­‰æ‰€æœ‰å¯è§ä¿¡æ¯ã€‚è¯·ç”¨ä¸­æ–‡å›ç­”ã€‚"
```

---

## ğŸ“‹ æ”¯æŒçš„æ ¼å¼

| æ ¼å¼ | æ‰©å±•å | æ–‡æœ¬æå– | å›¾ç‰‡æå– | å›¾ç‰‡åˆ†æ | ç‰¹æ®Šè¯´æ˜ |
|------|--------|----------|----------|----------|----------|
| çº¯æ–‡æœ¬ | .txt | âœ… | âŒ | âŒ | ç›´æ¥è¯»å– |
| Wordæ–‡æ¡£ | .docx | âœ… | âœ… | âœ… | XMLè§£æå®šä½ |
| Excelå·¥ä½œè¡¨ | .xlsx | âœ… | âŒ | âŒ | æ‰€æœ‰å·¥ä½œè¡¨ |
| PowerPoint | .pptx | âœ… | âœ… | âœ… | å¹»ç¯ç‰‡ç»“æ„ |
| XMindæ€ç»´å¯¼å›¾ | .xmind | âœ… | âœ… | âœ… | ç›´æ¥ZIPè§£æ |
| PDFæ–‡æ¡£ | .pdf | âœ… | âœ… | âœ… | é¡µé¢çº§æ£€æµ‹ |

---

## ğŸ› æ•…éšœæ’é™¤

### å¸¸è§é—®é¢˜

#### 1. PDFå­—ä½“è­¦å‘Š
**ç°è±¡**ï¼šå‡ºç°å¤§é‡ `Could get FontBBox from font descriptor` è­¦å‘Š
**è§£å†³**ï¼šâœ… å·²è‡ªåŠ¨æŠ‘åˆ¶ï¼Œæ— éœ€å¤„ç†

#### 2. å›¾ç‰‡è§£æä¸å®Œæ•´
**ç°è±¡**ï¼šåªæœ‰éƒ¨åˆ†å›¾ç‰‡è¢«è§£æ
**è§£å†³**ï¼šâœ… å·²ä¿®å¤ï¼Œç¨‹åºç°åœ¨é€ä¸ªè°ƒç”¨LLMç¡®ä¿100%å‡†ç¡®

#### 3. å‘½åç©ºé—´é”™è¯¯
**ç°è±¡**ï¼š`prefix 'a' not found in prefix map`
**è§£å†³**ï¼šâœ… å·²ä¿®å¤ï¼Œå‘½åç©ºé—´æ˜ å°„å·²å®Œæ•´å®šä¹‰

#### 4. APIå¯†é’¥é”™è¯¯
**ç°è±¡**ï¼š`Invalid API key provided`
**è§£å†³**ï¼š
1. æ£€æŸ¥APIå¯†é’¥æ˜¯å¦æ­£ç¡®
2. ç¡®ä¿è´¦æˆ·æœ‰è¶³å¤Ÿä½™é¢
3. éªŒè¯ç½‘ç»œè¿æ¥

#### 5. Poppleræœªå®‰è£…
**ç°è±¡**ï¼šPDFå›¾ç‰‡æ— æ³•æå–
**è§£å†³**ï¼š
- Windows: å®‰è£…Popplerå¹¶æ·»åŠ åˆ°PATH
- macOS: `brew install poppler`
- Linux: `sudo apt-get install poppler-utils`

#### 6. Excelæ–‡ä»¶è¢«å ç”¨
**ç°è±¡**ï¼š`PermissionError: [Errno 13] Permission denied`
**è§£å†³**ï¼šå…³é—­Excelç¨‹åºæˆ–å…¶ä»–å¯èƒ½æ‰“å¼€è¯¥æ–‡ä»¶çš„ç¨‹åº

#### 7. python-pptxæœªå®‰è£…
**ç°è±¡**ï¼šPPTXæ–‡ä»¶æ— æ³•è§£æ
**è§£å†³**ï¼š`pip install python-pptx`

#### 8. XMindæ–‡ä»¶æ— æ³•è§£æ
**ç°è±¡**ï¼šXMindæ–‡ä»¶è§£æå¤±è´¥
**è§£å†³**ï¼š
1. ç¡®ä¿ä½¿ç”¨çš„æ˜¯XMind Legacyæˆ–XMind Zenæ ¼å¼
2. æ£€æŸ¥æ–‡ä»¶æ˜¯å¦æŸå
3. ç¨‹åºä½¿ç”¨ç›´æ¥ZIPè§£æï¼Œæ— éœ€é¢å¤–ä¾èµ–

### è°ƒè¯•æ¨¡å¼

å¦‚éœ€æ›´è¯¦ç»†çš„è°ƒè¯•ä¿¡æ¯ï¼Œå¯ä»¥ä¸´æ—¶å¯ç”¨ï¼š

```python
# åœ¨write_file_excel.pyé¡¶éƒ¨æ·»åŠ 
import logging
logging.basicConfig(level=logging.DEBUG)
```

---

## ğŸ“š æ–‡æ¡£å¯¼èˆª

| æ–‡æ¡£ | ç”¨é€” |
|------|------|
| **README.md** | é¡¹ç›®æ€»è§ˆï¼ˆæœ¬æ–‡æ¡£ï¼‰ |
| **CLAUDE.md** | Claude Codeå¼€å‘æŒ‡å— |
| **QUICK_START.md** | 5åˆ†é’Ÿå¿«é€Ÿä¸Šæ‰‹ |
| **FAQ_FONT_WARNING.md** | PDFè­¦å‘Šé—®é¢˜FAQ |
| **IMAGE_POSITION_IMPROVEMENT.md** | å›¾ç‰‡ä½ç½®æ£€æµ‹ |
| **INDEX.md** | å®Œæ•´æ–‡æ¡£ç´¢å¼• |

---

## ğŸ¤ è´¡çŒ®

æ¬¢è¿æäº¤Issueå’ŒPull Requestï¼



---

## ğŸ“„ è®¸å¯è¯

MIT License - è¯¦è§ [LICENSE](LICENSE) æ–‡ä»¶

---

## ğŸ™ è‡´è°¢

æ„Ÿè°¢ä»¥ä¸‹å¼€æºé¡¹ç›®ï¼š
- [openpyxl](https://openpyxl.readthedocs.io/) - Excelæ–‡ä»¶å¤„ç†
- [python-docx](https://python-docx.readthedocs.io/) - Wordæ–‡æ¡£å¤„ç†
- [pdfplumber](https://github.com/jsvine/pdfplumber) - PDFæ–‡æœ¬æå–
- [pdf2image](https://github.com/Belval/pdf2image) - PDFå›¾ç‰‡æå–
- [qwen-vl](https://github.com/QwenLM) - å¤šæ¨¡æ€å¤§æ¨¡å‹

---

## ğŸ“ æ”¯æŒ

å¦‚æœ‰é—®é¢˜ï¼Œè¯·ï¼š
1. æŸ¥çœ‹ [FAQ_FONT_WARNING.md](FAQ_FONT_WARNING.md)
2. æŸ¥çœ‹ [INDEX.md](INDEX.md) è·å–ç›¸å…³æ–‡æ¡£
3. æäº¤Issueæè¿°é—®é¢˜

---

## ğŸ‰ å¼€å§‹ä½¿ç”¨

1. å®‰è£…ä¾èµ– â†’ 2. é…ç½®API â†’ 3. è¿è¡Œç¨‹åº â†’ 4. æŸ¥çœ‹ç»“æœ

**ç¥æ‚¨ä½¿ç”¨æ„‰å¿«ï¼**

[![å¼€å§‹ä½¿ç”¨](https://img.shields.io/badge/ğŸš€-å¼€å§‹ä½¿ç”¨-brightgreen)](write_file_excel.py)
